# DocSwap Supervisor Configuration
# Automatic process management and monitoring

[program:docswap]
command=/var/www/docswap/venv/bin/gunicorn --config /var/www/docswap/gunicorn.conf.py app:app
directory=/var/www/docswap
user=docswap
group=docswap
autostart=true
autorestart=true
startretries=3
redirect_stderr=true
stdout_logfile=/var/log/docswap/supervisor.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=10
environment=PATH="/var/www/docswap/venv/bin"

# Process priority (lower numbers = higher priority)
priority=100

# Kill timeout
stopwaitsecs=30
killasgroup=true
stopasgroup=true

# Resource limits
rlimit_nofile=65535

[program:docswap-cleanup]
command=/var/www/docswap/venv/bin/python /var/www/docswap/cleanup_files.py
directory=/var/www/docswap
user=docswap
group=docswap
autostart=true
autorestart=true
startretries=3
redirect_stderr=true
stdout_logfile=/var/log/docswap/cleanup.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=5
environment=PATH="/var/www/docswap/venv/bin"

# Run cleanup every hour
priority=200

[group:docswap-services]
programs=docswap,docswap-cleanup
priority=100