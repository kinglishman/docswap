/* DocSwap - Translations */

const translations = {
    en: {
        // Header
        home: "Home",
        features: "Features",
        contact: "Contact",
        
        // Hero
        tagline: "Free File Converter - PDF, Word, Excel & More",
        dragDrop: "Drag & drop your file here",
        or: "or",
        selectFile: "Click to select file",
        maxFileSize: "Max file size: 100MB",
        
        // AI Suggestion
        aiSuggestion: "AI Format Suggestion",
        aiError: "AI Suggestion Error",
        
        // Conversion
        chooseConversion: "Choose Conversion",
        selectFormat: "Select the desired output format for your file.",
        convertPdfTo: "Convert PDF to:",
        convertTo: "Convert to:",
        selectOutputFormat: "Select output format",
        advancedOptions: "Advanced Options",
        enableOcr: "Enable OCR (Extract text from images)",
        compressionLevel: "Compression Level:",
        none: "None",
        low: "Low",
        medium: "Medium",
        high: "High",
        convertNow: "Convert Now",
        
        // Results
        conversionComplete: "Conversion Complete!",
        previewDownload: "Your file has been successfully converted. Preview it below or download it now.",
        download: "Download",
        newConversion: "New Conversion",
        shareLink: "Your file will be available for 24 hours at this link:",
        copy: "Copy",
        copied: "Copied to clipboard!",
        
        // Features
        multipleFormats: "Multiple Formats",
        formatsDesc: "Convert to and from PDF with support for Word, Excel, PowerPoint, images, and more.",
        fastProcessing: "Fast Processing",
        processingDesc: "Get your converted files in seconds with our optimized conversion engine.",
        securePrivate: "Secure & Private",
        secureDesc: "Your files are automatically deleted after 24 hours. We never store your data permanently.",
        ocrTechnology: "OCR Technology",
        ocrDesc: "Extract text from scanned documents and images with our advanced OCR technology.",
        
        // Notifications
        uploading: "Uploading your file...",
        converting: "Converting your file...",
        errorFileSize: "File is too large. Maximum size is 100MB.",
        errorFileType: "Unsupported file type. Please try another file.",
        errorConversion: "Error during conversion. Please try again.",
        errorUpload: "Error uploading file. Please try again."
    },
    es: {
        // Header
        home: "Inicio",
        features: "Características",
        contact: "Contacto",
        
        // Hero
        tagline: "Convertidor Gratis - PDF, Word, Excel y Más",
        dragDrop: "Arrastra y suelta tu archivo aquí",
        or: "o",
        selectFile: "Haz clic para seleccionar archivo",
        maxFileSize: "Tamaño máximo de archivo: 100MB",
        
        // AI Suggestion
        aiSuggestion: "Sugerencia de Formato IA",
        aiError: "Error de Sugerencia IA",
        
        // Conversion
        chooseConversion: "Elige la Conversión",
        selectFormat: "Selecciona el formato de salida deseado para tu archivo.",
        convertPdfTo: "Convertir PDF a:",
        convertTo: "Convertir a:",
        selectOutputFormat: "Seleccionar formato de salida",
        advancedOptions: "Opciones Avanzadas",
        enableOcr: "Habilitar OCR (Extraer texto de imágenes)",
        compressionLevel: "Nivel de Compresión:",
        none: "Ninguno",
        low: "Bajo",
        medium: "Medio",
        high: "Alto",
        convertNow: "Convertir Ahora",
        
        // Results
        conversionComplete: "¡Conversión Completa!",
        previewDownload: "Tu archivo ha sido convertido exitosamente. Previsualízalo abajo o descárgalo ahora.",
        download: "Descargar",
        newConversion: "Nueva Conversión",
        shareLink: "Tu archivo estará disponible durante 24 horas en este enlace:",
        copy: "Copiar",
        copied: "¡Copiado al portapapeles!",
        
        // Features
        multipleFormats: "Múltiples Formatos",
        formatsDesc: "Convierte a y desde PDF con soporte para Word, Excel, PowerPoint, imágenes y más.",
        fastProcessing: "Procesamiento Rápido",
        processingDesc: "Obtén tus archivos convertidos en segundos con nuestro motor de conversión optimizado.",
        securePrivate: "Seguro y Privado",
        secureDesc: "Tus archivos se eliminan automáticamente después de 24 horas. Nunca almacenamos tus datos permanentemente.",
        ocrTechnology: "Tecnología OCR",
        ocrDesc: "Extrae texto de documentos escaneados e imágenes con nuestra avanzada tecnología OCR.",
        
        // Notifications
        uploading: "Subiendo tu archivo...",
        converting: "Convirtiendo tu archivo...",
        errorFileSize: "El archivo es demasiado grande. El tamaño máximo es 100MB.",
        errorFileType: "Tipo de archivo no soportado. Por favor, intenta con otro archivo.",
        errorConversion: "Error durante la conversión. Por favor, inténtalo de nuevo.",
        errorUpload: "Error al subir el archivo. Por favor, inténtalo de nuevo."
    },
    fr: {
        // Header
        home: "Accueil",
        features: "Fonctionnalités",
        contact: "Contact",
        
        // Hero
        tagline: "Convertisseur Gratuit - PDF, Word, Excel et Plus",
        dragDrop: "Glissez et déposez votre fichier ici",
        or: "ou",
        selectFile: "Cliquez pour sélectionner un fichier",
        maxFileSize: "Taille maximale de fichier: 100MB",
        
        // AI Suggestion
        aiSuggestion: "Suggestion de Format IA",
        aiError: "Erreur de Suggestion IA",
        
        // Conversion
        chooseConversion: "Choisissez la Conversion",
        selectFormat: "Sélectionnez le format de sortie souhaité pour votre fichier.",
        convertPdfTo: "Convertir PDF en:",
        convertTo: "Convertir en:",
        selectOutputFormat: "Sélectionner le format de sortie",
        advancedOptions: "Options Avancées",
        enableOcr: "Activer OCR (Extraire le texte des images)",
        compressionLevel: "Niveau de Compression:",
        none: "Aucun",
        low: "Faible",
        medium: "Moyen",
        high: "Élevé",
        convertNow: "Convertir Maintenant",
        
        // Results
        conversionComplete: "Conversion Terminée!",
        previewDownload: "Votre fichier a été converti avec succès. Prévisualisez-le ci-dessous ou téléchargez-le maintenant.",
        download: "Télécharger",
        newConversion: "Nouvelle Conversion",
        shareLink: "Votre fichier sera disponible pendant 24 heures à ce lien:",
        copy: "Copier",
        copied: "Copié dans le presse-papiers!",
        
        // Features
        multipleFormats: "Formats Multiples",
        formatsDesc: "Convertissez vers et depuis PDF avec prise en charge de Word, Excel, PowerPoint, images et plus.",
        fastProcessing: "Traitement Rapide",
        processingDesc: "Obtenez vos fichiers convertis en quelques secondes avec notre moteur de conversion optimisé.",
        securePrivate: "Sécurisé et Privé",
        secureDesc: "Vos fichiers sont automatiquement supprimés après 24 heures. Nous ne stockons jamais vos données de façon permanente.",
        ocrTechnology: "Technologie OCR",
        ocrDesc: "Extrayez du texte à partir de documents numérisés et d'images avec notre technologie OCR avancée.",
        
        // Notifications
        uploading: "Téléchargement de votre fichier...",
        converting: "Conversion de votre fichier...",
        errorFileSize: "Le fichier est trop volumineux. La taille maximale est de 100MB.",
        errorFileType: "Type de fichier non pris en charge. Veuillez essayer un autre fichier.",
        errorConversion: "Erreur lors de la conversion. Veuillez réessayer.",
        errorUpload: "Erreur lors du téléchargement du fichier. Veuillez réessayer."
    }
};

// Default language
let currentLanguage = 'en';

// Function to get a translation
function getTranslation(key) {
    const keys = key.split('.');
    let translation = translations[currentLanguage];
    
    for (const k of keys) {
        if (translation && translation[k]) {
            translation = translation[k];
        } else {
            // Fallback to English if translation not found
            let fallback = translations['en'];
            for (const k of keys) {
                if (fallback && fallback[k]) {
                    fallback = fallback[k];
                } else {
                    return key; // Return the key if no translation found
                }
            }
            return fallback;
        }
    }
    
    return translation;
}

// Function to set the language
function setLanguage(lang) {
    if (translations[lang]) {
        currentLanguage = lang;
        updatePageTranslations();
    }
}

// Function to update all translations on the page
function updatePageTranslations() {
    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        element.textContent = getTranslation(key);
    });
    
    // Update placeholders
    document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        element.placeholder = getTranslation(key);
    });
    
    // Update specific elements
    updateSpecificElements();
}

// Function to update specific elements that need special handling
function updateSpecificElements() {
    // Update the tagline
    const tagline = document.querySelector('.tagline');
    if (tagline) tagline.textContent = getTranslation('tagline');
    
    // Update drag & drop text
    const dropAreaText = document.querySelector('#drop-area p:first-of-type');
    if (dropAreaText) dropAreaText.textContent = getTranslation('dragDrop');
    
    // Update 'or' text
    const orText = document.querySelector('.upload-or');
    if (orText) orText.textContent = getTranslation('or');
    
    // Update select file button
    const selectBtn = document.querySelector('#file-select-btn');
    if (selectBtn) selectBtn.textContent = getTranslation('selectFile');
    
    // Update file limit text
    const fileLimit = document.querySelector('.file-limit');
    if (fileLimit) fileLimit.textContent = getTranslation('maxFileSize');
    
    // Update conversion label

    
    // Update select output format placeholder
    const outputFormat = document.querySelector('#output-format option[disabled]');
    if (outputFormat) outputFormat.textContent = getTranslation('selectOutputFormat');
    
    // Update advanced options toggle
    const advancedToggle = document.querySelector('.advanced-toggle span');
    if (advancedToggle) advancedToggle.textContent = getTranslation('advancedOptions');
    
    // Update OCR option
    const ocrOption = document.querySelector('label[for="ocr-option"]');
    if (ocrOption) ocrOption.textContent = getTranslation('enableOcr');
    
    // Update compression level label
    const compressionLabel = document.querySelector('label[for="compression-level"]');
    if (compressionLabel) compressionLabel.textContent = getTranslation('compressionLevel');
    
    // Update compression level options
    const compressionOptions = document.querySelectorAll('#compression-level option');
    if (compressionOptions.length > 0) {
        compressionOptions[0].textContent = getTranslation('none');
        compressionOptions[1].textContent = getTranslation('low');
        compressionOptions[2].textContent = getTranslation('medium');
        compressionOptions[3].textContent = getTranslation('high');
    }
    
    // Update convert button
    const convertBtn = document.querySelector('#convert-btn');
    if (convertBtn) convertBtn.textContent = getTranslation('convertNow');
    
    // Update result header
    const resultHeader = document.querySelector('.result-header h3');
    if (resultHeader) resultHeader.textContent = getTranslation('conversionComplete');
    
    const resultDesc = document.querySelector('.result-header p');
    if (resultDesc) resultDesc.textContent = getTranslation('previewDownload');
    
    // Update download button
    const downloadBtn = document.querySelector('#download-btn');
    if (downloadBtn) {
        // Check if there's already text content in the button
        let textNode = null;
        let svgNode = null;
        
        // Find the text node and SVG node
        for (let i = 0; i < downloadBtn.childNodes.length; i++) {
            if (downloadBtn.childNodes[i].nodeType === 3 && downloadBtn.childNodes[i].textContent.trim()) {
                textNode = downloadBtn.childNodes[i];
            } else if (downloadBtn.childNodes[i].nodeName === 'svg') {
                svgNode = downloadBtn.childNodes[i];
            }
        }
        
        // If text node exists, update it; otherwise create a new one
        if (textNode) {
            textNode.textContent = getTranslation('download');
        } else if (downloadBtn.childNodes.length > 1) {
            const downloadText = document.createTextNode(getTranslation('download'));
            // Insert after the SVG icon if it exists
            if (svgNode && svgNode.nextSibling) {
                downloadBtn.replaceChild(downloadText, svgNode.nextSibling);
            } else {
                downloadBtn.appendChild(downloadText);
            }
        }
    }
    
    // Update new conversion button
    const newConversionBtn = document.querySelector('#new-conversion-btn');
    if (newConversionBtn) newConversionBtn.textContent = getTranslation('newConversion');
    
    // Update share link text
    const shareLinkText = document.querySelector('.share-link p');
    if (shareLinkText) shareLinkText.textContent = getTranslation('shareLink');
    
    // Update copy button
    const copyBtn = document.querySelector('#copy-link-btn');
    if (copyBtn) copyBtn.textContent = getTranslation('copy');
    
    // Update feature headings and descriptions
    const featureHeadings = document.querySelectorAll('.feature-card h3');
    const featureDescs = document.querySelectorAll('.feature-card p');
    
    if (featureHeadings.length >= 4 && featureDescs.length >= 4) {
        featureHeadings[0].textContent = getTranslation('multipleFormats');
        featureDescs[0].textContent = getTranslation('formatsDesc');
        
        featureHeadings[1].textContent = getTranslation('fastProcessing');
        featureDescs[1].textContent = getTranslation('processingDesc');
        
        featureHeadings[2].textContent = getTranslation('securePrivate');
        featureDescs[2].textContent = getTranslation('secureDesc');
        
        featureHeadings[3].textContent = getTranslation('ocrTechnology');
        featureDescs[3].textContent = getTranslation('ocrDesc');
    }
}

// Initialize language from browser preference or localStorage
function initializeLanguage() {
    // Check if language is stored in localStorage
    const storedLang = localStorage.getItem('docswap-language');
    if (storedLang && translations[storedLang]) {
        currentLanguage = storedLang;
    } else {
        // Check browser language
        const browserLang = navigator.language.split('-')[0];
        if (translations[browserLang]) {
            currentLanguage = browserLang;
        }
    }
    
    // Set the language selector value
    const langSelect = document.querySelector('#language-select');
    if (langSelect) {
        langSelect.value = currentLanguage;
    }
    
    // Update all translations
    updatePageTranslations();
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    initializeLanguage();
    
    // Set up language selector
    const langSelect = document.querySelector('#language-select');
    if (langSelect) {
        langSelect.addEventListener('change', (e) => {
            const newLang = e.target.value;
            setLanguage(newLang);
            localStorage.setItem('docswap-language', newLang);
        });
    }
});